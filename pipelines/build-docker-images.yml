groups:
- name: cf-deployment-concourse-tasks
  jobs:
  - build-cf-deployment-concourse-tasks-docker-image
- name: cats-concourse-task
  jobs:
  - build-cats-concourse-task-docker-image
- name: runtime-ci-common-images
  jobs:
  - build-relint-base-docker-image
  - build-bosh-cli-docker-image
  - build-bosh-and-spiff-docker-image
- name: build-docker-images
  jobs:
  - trigger-all-image-builds
  - build-announce-rc-docker-image
  - build-can-bump-docker-image
  - build-wait-for-endpoint-docker-image
  - build-cannot-bump-docker-image
  - build-generate-release-manifest-docker-image
  - build-create-final-release-docker-image
  - build-create-release-docker-image
  - build-create-release-notes-template-docker-image
  - build-delete-deployment-docker-image
  - build-enable-docker-diego-1-0-docker-image
  - build-merge-master-into-develop-docker-image
  - build-record-compatible-versions-docker-image
  - build-run-bosh-cleanup-1.0-docker-image
  - build-run-rats-docker-image
  - build-run-cf-release-unit-tests-docker-image
  - build-run-errand-docker-image
  - build-run-smoketests-docker-image
  - build-validate-all-jobs-public-docker-image
  - build-validate-branch-freshness-docker-image
  - build-create-diego-manifest-docker-image
  - build-create-diego-manifest-with-config-docker-image
  - build-write-target-file-docker-image
  - build-write-creds-docker-image
  - build-bosh-upload-stemcell-docker-image
  - build-verify-every-task-has-correct-docker-image-docker-image
  - build-verify-every-task-has-docker-build-docker-image
  - build-verify-every-task-is-used-in-a-pipeline-docker-image
  - build-create-diego-iaas-settings-docker-image
  - build-bind-elb-to-r53-docker-image
  - build-unbind-elb-from-r53-docker-image
  - build-recreate-datadog-dashboards-docker-image
  - build-commit-generated-manifest-docker-image
  - build-write-build-url-docker-image
  - build-write-director-version-docker-image
  - build-untar-release-docker-image
  - build-build-metadata-resource-docker-image

resources:
- name: runtime-ci
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git

- name: weekly
  type: time
  source:
    start: 7:00 -0700
    stop: 7:30 -0700
    interval: 168h

- name: weekly-1
  type: time
  source:
    start: 3:00 -0700
    stop: 3:30 -0700
    interval: 168h

- name: weekly-2
  type: time
  source:
    start: 5:00 -0700
    stop: 5:30 -0700
    interval: 168h

- name: trigger-resource
  type: time
  source:
    interval: 2h

- name: runtime-ci-create-version-json
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-version-json/Dockerfile]

- name: runtime-ci-build-metadata-resource
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [resources/build-metadata-resource/*]

- name: runtime-ci-create-diego-iaas-settings
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-diego-iaas-settings/Dockerfile]
- name: runtime-ci-verify-every-task-has-docker-build
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/verify-every-task-has-docker-build/Dockerfile]
- name: runtime-ci-verify-every-task-is-used-in-a-pipeline
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/verify-every-task-is-used-in-a-pipeline/Dockerfile]
- name: runtime-ci-verify-every-task-has-correct-docker-image
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/verify-every-task-has-correct-docker-image/Dockerfile]
- name: runtime-ci-create-diego-manifest
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-diego-manifest/Dockerfile]
- name: runtime-ci-create-diego-manifest-with-config
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-diego-manifest-with-config/Dockerfile]
- name: runtime-ci-write-target-file
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/write-target-file/Dockerfile]
- name: runtime-ci-write-creds
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/write-creds/Dockerfile]
- name: cf-deployment-concourse-tasks
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/cf-deployment-concourse-tasks.git
    private_key: {{cfdct_readwrite_deploy_key}}
    paths: [dockerfiles/cf-deployment-concourse-tasks/Dockerfile]
- name: uptimer
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/uptimer.git
- name: runtime-ci-bosh-upload-stemcell
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/bosh-upload-stemcell/Dockerfile]
- name: runtime-ci-announce-rc
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/announce-rc/Dockerfile]
- name: runtime-ci-can-bump
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/can-bump/Dockerfile]
- name: runtime-ci-wait-for-endpoint
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/wait-for-endpoint/Dockerfile]
- name: runtime-ci-cannot-bump
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/cannot-bump/Dockerfile]
- name: runtime-ci-generate-release-manifest
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/generate-release-manifest/Dockerfile]
- name: runtime-ci-create-final-release
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-final-release/Dockerfile]
- name: runtime-ci-create-release
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-release/Dockerfile]
- name: runtime-ci-create-release-notes-template
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/create-release-notes-template/Dockerfile]
- name: runtime-ci-delete-deployment
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/delete-deployment/Dockerfile]
- name: runtime-ci-enable-docker-diego-1-0
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/enable-docker-diego-1-0/Dockerfile]
- name: runtime-ci-merge-master-into-develop
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/merge-master-into-develop/Dockerfile]
- name: runtime-ci-record-compatible-versions
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/record-compatible-versions/Dockerfile]
- name: runtime-ci-run-bosh-cleanup-1.0
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/run-bosh-cleanup-1.0/Dockerfile]
- name: runtime-ci-run-rats
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/run-rats]
- name: runtime-ci-run-cf-release-unit-tests
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/run-cf-release-unit-tests/Dockerfile]
- name: runtime-ci-run-errand
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/run-errand/Dockerfile]
- name: runtime-ci-run-smoketests
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/run-smoketests/Dockerfile]
- name: runtime-ci-validate-all-jobs-public
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/validate-all-jobs-public/Dockerfile]
- name: runtime-ci-validate-branch-freshness
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/validate-branch-freshness/Dockerfile]
- name: runtime-ci-bind-elb-to-r53
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/bind-elb-to-r53/Dockerfile]
- name: runtime-ci-unbind-elb-from-r53
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/unbind-elb-from-r53/Dockerfile]
- name: runtime-ci-recreate-datadog-dashboards
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths:
    - scripts/ci/recreate-datadog-dashboards/Dockerfile
    - scripts/ci/recreate-datadog-dashboards/Gemfile.lock
- name: runtime-ci-commit-generated-manifest
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/commit-generated-manifest/Dockerfile]

- name: runtime-ci-write-build-url
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/write-build-url/Dockerfile]

- name: runtime-ci-write-director-version
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/write-director-version/Dockerfile]

- name: runtime-ci-untar-release
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [scripts/ci/untar-release/Dockerfile]

- name: cats-concourse-task
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/cats-concourse-task.git
    paths: [Dockerfile]

- name: runtime-ci-relint-base
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [dockerfiles/relint-base/Dockerfile]

- name: runtime-ci-bosh-cli
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [dockerfiles/bosh-cli/Dockerfile]

- name: runtime-ci-bosh-and-spiff
  type: git
  source:
    branch: master
    uri: https://github.com/cloudfoundry/runtime-ci.git
    paths: [dockerfiles/bosh-and-spiff/Dockerfile]

- name: cf-cli
  type: github-release
  source:
    user: cloudfoundry
    repository: cli
    access_token: {{release_integration_download_bot_access_token}}

- name: bosh-cli-github-release
  type: github-release
  source:
    user: cloudfoundry
    repository: bosh-cli
    access_token: {{release_integration_download_bot_access_token}}

- name: terraform-github-release
  type: github-release
  source:
    user: hashicorp
    repository: terraform
    access_token: {{release_integration_download_bot_access_token}}

- name: bbl-github-release
  type: github-release
  source:
    user: cloudfoundry
    repository: bosh-bootloader
    access_token: {{release_integration_download_bot_access_token}}

  # All the docker images
- name: create-diego-iaas-settings-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-diego-iaas-settings
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: verify-every-task-has-docker-build-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/verify-every-task-has-docker-build
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: verify-every-task-is-used-in-a-pipeline-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/verify-every-task-is-used-in-a-pipeline
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: verify-every-task-has-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/verify-every-task-has-correct-docker-image
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: create-diego-manifest-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-diego-manifest
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: create-diego-manifest-with-config-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-diego-manifest-with-config
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: write-target-file-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/write-target-file
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: write-creds-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/write-creds
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: cf-deployment-concourse-tasks-docker-image-version
  type: semver
  source:
    driver: git
    uri: git@github.com:cloudfoundry/cf-relint-ci-semver.git
    branch: master
    file: cf-deployment-concourse-tasks-docker-image-version
    private_key: {{cf_deployment_concourse_tasks_docker_image_version_repo_private_key}}
- name: cf-deployment-concourse-tasks-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/cf-deployment-concourse-tasks
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: bosh-upload-stemcell-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/bosh-upload-stemcell
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-stemcell-integration+dockerhub-push-bot@pivotal.io
- name: announce-rc-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/announce-rc
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: can-bump-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/can-bump
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: wait-for-endpoint-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/wait-for-endpoint
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: cannot-bump-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/cannot-bump
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: generate-release-manifest-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/generate-release-manifest
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: create-final-release-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-final-release
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: create-release-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-release
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: create-release-notes-template-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-release-notes-template
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: delete-deployment-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/delete-deployment
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: enable-docker-diego-1-0-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/enable-docker-diego-1-0
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: merge-master-into-develop-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/merge-master-into-develop
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: record-compatible-versions-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/record-compatible-versions
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: run-bosh-cleanup-1.0-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/run-bosh-cleanup-1.0
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: run-rats-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/run-rats
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: run-cf-release-unit-tests-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/run-cf-release-unit-tests
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: run-errand-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/run-errand
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: run-smoketests-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/run-smoketests
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: validate-all-jobs-public-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/validate-all-jobs-public
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: validate-branch-freshness-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/validate-branch-freshness
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: bind-elb-to-r53-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/bind-elb-to-r53
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: unbind-elb-from-r53-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/unbind-elb-from-r53
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io
- name: recreate-datadog-dashboards-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/recreate-datadog-dashboards
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: commit-generated-manifest-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/commit-generated-manifest
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: write-build-url-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/write-build-url
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: write-director-version-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/write-director-version
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: untar-release-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/untar-release
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: build-metadata-resource-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/build-metadata-resource
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: cats-concourse-task-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/cats-concourse-task
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: create-version-json-pipeline-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/create-version-json
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: relint-base-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/relint-base
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: bosh-cli-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/bosh-cli
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

- name: bosh-and-spiff-image
  type: docker-image
  source:
    repository: relintdockerhubpushbot/bosh-and-spiff
    username: {{dockerhub_username}}
    password: {{dockerhub_password}}
    email: cf-release-integration+dockerhub-push-bot@pivotal.io

jobs:
- name: trigger-all-image-builds
  public: true
  serial: true
  build_logs_to_retain: 100
  plan:
  - get: trigger-resource

- name: build-create-diego-iaas-settings-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-create-diego-iaas-settings
        trigger: true
    - put: create-diego-iaas-settings-pipeline-image
      params:
        build: runtime-ci-create-diego-iaas-settings/scripts/ci/create-diego-iaas-settings
        push: true
- name: build-verify-every-task-has-docker-build-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-verify-every-task-has-docker-build
        trigger: true
    - put: verify-every-task-has-docker-build-pipeline-image
      params:
        build: runtime-ci-verify-every-task-has-docker-build/scripts/ci/verify-every-task-has-docker-build
        push: true
- name: build-verify-every-task-is-used-in-a-pipeline-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-verify-every-task-is-used-in-a-pipeline
        trigger: true
    - put: verify-every-task-is-used-in-a-pipeline-pipeline-image
      params:
        build: runtime-ci-verify-every-task-is-used-in-a-pipeline/scripts/ci/verify-every-task-is-used-in-a-pipeline
        push: true
- name: build-verify-every-task-has-correct-docker-image-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-verify-every-task-has-correct-docker-image
        trigger: true
    - put: verify-every-task-has-pipeline-image
      params:
        build: runtime-ci-verify-every-task-has-correct-docker-image/scripts/ci/verify-every-task-has-correct-docker-image
        push: true

- name: build-cf-deployment-concourse-tasks-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: runtime-ci
      - get: weekly
        trigger: true
      - get: uptimer
        trigger: true
      - get: cf-deployment-concourse-tasks
        trigger: true
      # We aren't using cf-deployment-concourse-tasks-docker-image-version
      # but we want to keep it here for use in a future workflow
      # where we semantically version the docker image, so we need to `get`
      # the resource somewhere or concourse will complain.
      - get: cf-deployment-concourse-tasks-docker-image-version
      - get: runtime-ci-create-version-json
      - get: terraform-github-release
        trigger: true
      - get: bbl-github-release
        trigger: true
      - get: bosh-cli-github-release
        trigger: true
    - task: update-dockerfile-versions
      file: runtime-ci/tasks/update-cf-d-ct-dockerfile-versions/task.yml
    - put: cf-deployment-concourse-tasks-pipeline-image
      params:
        build: cf-deployment-concourse-tasks-updated/dockerfiles/cf-deployment-concourse-tasks
        push: true
    - put: cf-deployment-concourse-tasks
      params:
        repository: cf-deployment-concourse-tasks-updated
        rebase: true
    - task: create-pm-story
      file: runtime-ci/tasks/create-pm-story/task.yml
      input_mapping:
        input-description: version-json
      params:
        TRACKER_STORY_NAME: "New cf-deployment-concourse-tasks docker image"
        TRACKER_STORY_STATE: delivered
        TRACKER_API_TOKEN: {{cf_mega_api_token}}
        DESCRIPTION_FILE: version.json

- name: build-bosh-upload-stemcell-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-bosh-upload-stemcell
        trigger: true
    - put: bosh-upload-stemcell-pipeline-image
      params:
        build: runtime-ci-bosh-upload-stemcell/scripts/ci/bosh-upload-stemcell
        push: true
- name: build-write-target-file-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-write-target-file
        trigger: true
    - put: write-target-file-pipeline-image
      params:
        build: runtime-ci-write-target-file/scripts/ci/write-target-file
        push: true
- name: build-write-creds-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-write-creds
        trigger: true
    - put: write-creds-pipeline-image
      params:
        build: runtime-ci-write-creds/scripts/ci/write-creds
        push: true
- name: build-create-diego-manifest-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-create-diego-manifest
        trigger: true
    - put: create-diego-manifest-pipeline-image
      params:
        build: runtime-ci-create-diego-manifest/scripts/ci/create-diego-manifest
        push: true
- name: build-create-diego-manifest-with-config-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-create-diego-manifest-with-config
        trigger: true
    - put: create-diego-manifest-with-config-pipeline-image
      params:
        build: runtime-ci-create-diego-manifest-with-config/scripts/ci/create-diego-manifest-with-config
        push: true
- name: build-announce-rc-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-announce-rc
        trigger: true
    - put: announce-rc-pipeline-image
      params:
        build: runtime-ci-announce-rc/scripts/ci/announce-rc
        push: true
- name: build-can-bump-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-can-bump
        trigger: true
    - put: can-bump-pipeline-image
      params:
        build: runtime-ci-can-bump/scripts/ci/can-bump
        push: true
- name: build-wait-for-endpoint-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-wait-for-endpoint
        trigger: true
    - put: wait-for-endpoint-pipeline-image
      params:
        build: runtime-ci-wait-for-endpoint/scripts/ci/wait-for-endpoint
        push: true
- name: build-cannot-bump-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-cannot-bump
        trigger: true
    - put: cannot-bump-pipeline-image
      params:
        build: runtime-ci-cannot-bump/scripts/ci/cannot-bump
        push: true
- name: build-generate-release-manifest-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-generate-release-manifest
        trigger: true
    - put: generate-release-manifest-pipeline-image
      params:
        build: runtime-ci-generate-release-manifest/scripts/ci/generate-release-manifest
        push: true
- name: build-create-final-release-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-create-final-release
        trigger: true
    - put: create-final-release-pipeline-image
      params:
        build: runtime-ci-create-final-release/scripts/ci/create-final-release
        push: true
- name: build-create-release-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-create-release
        trigger: true
    - put: create-release-pipeline-image
      params:
        build: runtime-ci-create-release/scripts/ci/create-release
        push: true
- name: build-create-release-notes-template-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-create-release-notes-template
        trigger: true
    - put: create-release-notes-template-pipeline-image
      params:
        build: runtime-ci-create-release-notes-template/scripts/ci/create-release-notes-template
        push: true
- name: build-delete-deployment-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-delete-deployment
        trigger: true
    - put: delete-deployment-pipeline-image
      params:
        build: runtime-ci-delete-deployment/scripts/ci/delete-deployment
        push: true
- name: build-enable-docker-diego-1-0-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-enable-docker-diego-1-0
        trigger: true
    - put: enable-docker-diego-1-0-pipeline-image
      params:
        build: runtime-ci-enable-docker-diego-1-0/scripts/ci/enable-docker-diego-1-0
        push: true
- name: build-merge-master-into-develop-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-merge-master-into-develop
        trigger: true
    - put: merge-master-into-develop-pipeline-image
      params:
        build: runtime-ci-merge-master-into-develop/scripts/ci/merge-master-into-develop
        push: true
- name: build-record-compatible-versions-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-record-compatible-versions
        trigger: true
    - put: record-compatible-versions-pipeline-image
      params:
        build: runtime-ci-record-compatible-versions/scripts/ci/record-compatible-versions
        push: true
- name: build-run-bosh-cleanup-1.0-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-run-bosh-cleanup-1.0
        trigger: true
    - put: run-bosh-cleanup-1.0-pipeline-image
      params:
        build: runtime-ci-run-bosh-cleanup-1.0/scripts/ci/run-bosh-cleanup-1.0
        push: true

- name: build-run-rats-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-run-rats
        trigger: true
      - get: cf-cli
        trigger: true
    - put: run-rats-pipeline-image
      params:
        build: runtime-ci-run-rats/scripts/ci/run-rats
        push: true

- name: build-run-cf-release-unit-tests-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-run-cf-release-unit-tests
        trigger: true
    - put: run-cf-release-unit-tests-pipeline-image
      params:
        build: runtime-ci-run-cf-release-unit-tests/scripts/ci/run-cf-release-unit-tests
        push: true
- name: build-run-errand-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-run-errand
        trigger: true
    - put: run-errand-pipeline-image
      params:
        build: runtime-ci-run-errand/scripts/ci/run-errand
        push: true
- name: build-run-smoketests-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-run-smoketests
        trigger: true
    - put: run-smoketests-pipeline-image
      params:
        build: runtime-ci-run-smoketests/scripts/ci/run-smoketests
        push: true
- name: build-validate-all-jobs-public-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-validate-all-jobs-public
        trigger: true
    - put: validate-all-jobs-public-pipeline-image
      params:
        build: runtime-ci-validate-all-jobs-public/scripts/ci/validate-all-jobs-public
        push: true
- name: build-validate-branch-freshness-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-validate-branch-freshness
        trigger: true
    - put: validate-branch-freshness-pipeline-image
      params:
        build: runtime-ci-validate-branch-freshness/scripts/ci/validate-branch-freshness
        push: true
- name: build-bind-elb-to-r53-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-bind-elb-to-r53
        trigger: true
    - put: bind-elb-to-r53-pipeline-image
      params:
        build: runtime-ci-bind-elb-to-r53/scripts/ci/bind-elb-to-r53
        push: true
- name: build-unbind-elb-from-r53-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-unbind-elb-from-r53
        trigger: true
    - put: unbind-elb-from-r53-pipeline-image
      params:
        build: runtime-ci-unbind-elb-from-r53/scripts/ci/unbind-elb-from-r53
        push: true

- name: build-recreate-datadog-dashboards-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-recreate-datadog-dashboards
        trigger: true
    - put: recreate-datadog-dashboards-pipeline-image
      params:
        build: runtime-ci-recreate-datadog-dashboards/scripts/ci/recreate-datadog-dashboards
        push: true

- name: build-commit-generated-manifest-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-commit-generated-manifest
        trigger: true
    - put: commit-generated-manifest-pipeline-image
      params:
        build: runtime-ci-commit-generated-manifest/scripts/ci/commit-generated-manifest
        push: true

- name: build-write-build-url-docker-image
  public: true
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-write-build-url
        trigger: true
    - put: write-build-url-pipeline-image
      params:
        build: runtime-ci-write-build-url/scripts/ci/write-build-url
        push: true

- name: build-write-director-version-docker-image
  public: true
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-write-director-version
        trigger: true
    - put: write-director-version-pipeline-image
      params:
        build: runtime-ci-write-director-version/scripts/ci/write-director-version
        push: true

- name: build-untar-release-docker-image
  public: true
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-2
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-untar-release
        trigger: true
    - put: untar-release-pipeline-image
      params:
        build: runtime-ci-untar-release/scripts/ci/untar-release
        push: true

- name: build-build-metadata-resource-docker-image
  public: true
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly-1
        trigger: true
      - get: trigger-resource
        trigger: true
        passed: [trigger-all-image-builds]
      - get: runtime-ci-build-metadata-resource
        trigger: true
    - put: build-metadata-resource-pipeline-image
      params:
        build: runtime-ci-build-metadata-resource/resources/build-metadata-resource
        push: true

- name: build-cats-concourse-task-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - do:
    - aggregate:
      - get: runtime-ci
      - get: runtime-ci-create-version-json
      - get: weekly
        trigger: true
      - get: cats-concourse-task
        trigger: true
      - get: cf-cli
        trigger: true
    - put: create-version-json-pipeline-image
      params:
        build: runtime-ci-create-version-json/scripts/ci/create-version-json
        push: true
    - task: create-version-json
      file: runtime-ci/scripts/ci/create-version-json/task.yml
      input_mapping:
        version: cf-cli
        input-version-json: cf-cli
    - put: cats-concourse-task-pipeline-image
      params:
        build: cats-concourse-task
        push: true
        build_args_file: version-json/version.json
    timeout: 4h

- name: build-relint-base-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly
        trigger: true
      - get: runtime-ci-relint-base
        trigger: true
    - put: relint-base-image
      params:
        build: runtime-ci-relint-base/dockerfiles/relint-base/
        push: true

- name: build-bosh-cli-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly
        trigger: true
      - get: runtime-ci
      - get: runtime-ci-bosh-cli
        trigger: true
      - get: relint-base-image
        trigger: true
        passed: [build-relint-base-docker-image]
      - get: bosh-cli-github-release
        trigger: true
      - get: bbl-github-release
        trigger: true
      - get: terraform-github-release
        trigger: true
    - task: create-bosh-cli-json
      file: runtime-ci/scripts/ci/create-version-json/task.yml
      input_mapping:
        version: bosh-cli-github-release
        # This is an example of that chaining we spoke of earlier
        input-version-json: bosh-cli-github-release
      params:
        key: bosh_cli_version
    - task: create-bbl-json
      file: runtime-ci/scripts/ci/create-version-json/task.yml
      input_mapping:
        version: bbl-github-release
        # This is an example of that chaining we spoke of earlier
        input-version-json: version-json
      params:
        key: bbl_version
    - task: create-terraform-json
      file: runtime-ci/scripts/ci/create-version-json/task.yml
      input_mapping:
        version: terraform-github-release
        # This is an example of that chaining we spoke of earlier
        input-version-json: version-json
      params:
        key: terraform_version
    - put: bosh-cli-image
      params:
        build: runtime-ci-bosh-cli/dockerfiles/bosh-cli/
        push: true
        build_args_file: version-json/version.json

- name: build-bosh-and-spiff-docker-image
  public: true
  build_logs_to_retain: 100
  plan:
  - timeout: 4h
    do:
    - aggregate:
      - get: weekly
        trigger: true
      - get: runtime-ci-bosh-and-spiff
        trigger: true
      - get: bosh-cli-image
        passed: [build-bosh-cli-docker-image]
        trigger: true
    - put: bosh-and-spiff-image
      params:
        build: runtime-ci-bosh-and-spiff/dockerfiles/bosh-and-spiff/
        push: true
